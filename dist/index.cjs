'use strict';var c={className:"sticky-polite",attrName:"data-polite-state",epsilon:1};var P=t=>{if(!t.valid)return {x:0,y:0};let{edge:e,offset:o}=t;switch(e){case "top":return {x:0,y:o};case "bottom":return {x:0,y:-o};case "left":return {x:o,y:0};case "right":return {x:-o,y:0}}};var H={top:0,bottom:0,left:0,right:0},A=()=>{if(document.getElementById("sticky-polite-beacon"))return;let t=document.createElement("style");t.id="sticky-polite-beacon",t.innerHTML=`
    @keyframes sticky-polite-announce { 
      from { opacity: 0.999; } 
      to { opacity: 1; } 
    }
    .${c.className} { 
      animation-duration: 1ms; 
      animation-name: sticky-polite-announce; 
    }
  `,document.head.appendChild(t);},z=t=>{if(t instanceof Window)return H;let e=getComputedStyle(t);return {top:parseInt(e.paddingTop,10)||0,bottom:parseInt(e.paddingBottom,10)||0,left:parseInt(e.paddingLeft,10)||0,right:parseInt(e.paddingRight,10)||0}},E=(t,e,o)=>{let{element:i,cachedConfig:l}=t,r=P(l),a=e-r.x,n=o-r.y;i.style.position="relative",i.style.transform=`translate3d(${a}px, ${n}px, 0)`,i.setAttribute(c.attrName,"intersect"),t.currentTranslation=e!==0?e:o;},T=t=>{t.style.position="sticky",t.style.transform="",t.setAttribute(c.attrName,"sticky");},v=t=>{let{element:e,cachedConfig:o}=t,i=P(o);e.style.position="relative",e.style.transform=`translate3d(${-i.x}px, ${-i.y}px, 0)`,e.setAttribute(c.attrName,"static");},F=(t,e)=>{let o=e==="top"||e==="bottom";return t===document.documentElement?window.visualViewport?o?window.visualViewport.height:window.visualViewport.width:o?window.innerHeight:window.innerWidth:o?t.clientHeight:t.clientWidth},I=(t,e)=>{let o=t===document.documentElement;return e==="left"||e==="right"?o?window.scrollX:t.scrollLeft:o?window.scrollY:t.scrollTop},N=t=>{if(!t||t===document.body)return document.documentElement;let o=getComputedStyle(t).overflowY;return o!=="visible"&&o!=="hidden"&&t.scrollHeight>=t.clientHeight?t:N(t.parentElement)},R=t=>{let e=t,o=0,i=0;for(;e;)o+=e.offsetTop,i+=e.offsetLeft,e=e.offsetParent;return {top:o,left:i}},B=(t,e)=>{let o=t.hasAttribute(c.attrName),i=t.style.position,l=t.style.transform;o&&(t.style.position="relative",t.style.transform="");let{width:r,height:a}=t.getBoundingClientRect(),n=R(t);if(o&&(t.style.position=i,t.style.transform=l),e===document.documentElement)return {top:n.top,left:n.left,width:r,height:a,bottom:n.top+a,right:n.left+r,x:n.left,y:n.top,toJSON:()=>{}};let s=R(e),d=n.top-s.top-(e.clientTop||0),f=n.left-s.left-(e.clientLeft||0);return {top:d,left:f,width:r,height:a,bottom:d+a,right:f+r,x:f,y:d,toJSON:()=>{}}},W=(t,e)=>{let o=t.getBoundingClientRect(),i;return e===document.documentElement?window.visualViewport?i={top:0,left:0,bottom:window.visualViewport.height,right:window.visualViewport.width}:i={top:0,left:0,bottom:window.innerHeight,right:window.innerWidth}:i=e.getBoundingClientRect(),o.bottom<i.top||o.top>i.bottom||o.right<i.left||o.left>i.right},$=t=>{let e=t.style.position,o=t.hasAttribute(c.attrName);o&&(t.style.position="");let i=["top","bottom","left","right"],l=null,r=0;if("computedStyleMap"in t)try{let a=t.computedStyleMap();for(let n of i){let s=a.get(n);if(s&&"value"in s&&typeof s.value=="number"){if(l)return o&&(t.style.position=e),{valid:!1,edge:"top",offset:0};l=n,r=s.value;}}}catch{}if(!l){let a=getComputedStyle(t);for(let n of i){let s=a.getPropertyValue(n);if(s&&s!=="auto"&&s!==""){if(l)return o&&(t.style.position=e),{valid:false,edge:"top",offset:0};l=n,r=parseFloat(s)||0;}}}return o&&(t.style.position=e),l?{valid:true,edge:l,offset:r}:{valid:false,edge:"top",offset:0}};var V=t=>{let{element:e,parent:o,lastScrollPos:i,naturalRect:l,cachedConfig:r,cachedViewportSize:a}=t,{edge:n}=r;if(!r.valid){(t.isSticky||t.isTransforming)&&(e.style.position="static",e.style.transform="",t.isSticky=false,t.isTransforming=false);return}let s=n==="top"||n==="left",d=n==="top"||n==="bottom",f=I(o,n),b=f-i,Y=t.cachedViewportPadding[n],g=r.offset+Y;t.lastScrollPos=f;let p=d?l.top:l.left,w=d?l.height:l.width,j=s?b>0:b<0,J=s?b<0:b>0,k=false;if(s?k=p>=f+g-c.epsilon:k=p+w<=f+a-g+c.epsilon,k){(t.isSticky||t.isTransforming)&&(v(t),t.isSticky=false,t.isTransforming=false);return}if(j){if(t.isSticky){let m=0;s?m=f+g-p:m=f+a-g-w-p,d?E(t,0,m):E(t,m,0),t.isSticky=false,t.isTransforming=true;}t.isTransforming&&W(e,o)&&(v(t),t.isTransforming=false);return}if(J){let m=false;if(s?m=p+w<f:m=p>f+a,!t.isSticky&&!t.isTransforming&&m){let u=0;s?u=f-w-p:u=f+a-p,d?E(t,0,u):E(t,u,0),t.isTransforming=true;}if(t.isTransforming){let u=p+t.currentTranslation,S=false;if(s){let C=f+g;S=u>=C-c.epsilon;}else {let C=f+a-g;S=u+w<=C+c.epsilon;}S&&(T(e),t.isSticky=true,t.isTransforming=false);}}};var y=new Map,h=new Map,O=new WeakMap,q=t=>{let{element:e,parent:o}=t;t.cachedConfig=$(e),t.naturalRect=B(e,o),t.cachedViewportSize=F(o,t.cachedConfig.edge),t.cachedViewportPadding=z(o),t.isSticky?T(e):(v(t),t.isTransforming=false),V(t);},G=t=>{O.get(t)||(window.requestAnimationFrame(()=>{q(t),O.set(t,false);}),O.set(t,true));},U=t=>{let e=new Set(t.map(o=>o.target));for(let o of y.values())(e.has(o.element)||e.has(o.parent))&&G(o);},D=()=>{for(let t of y.values())(t.parent===document.documentElement||t.parent===document.body)&&G(t);},M=new ResizeObserver(U),L=t=>{if(y.has(t))return;let e=N(t),o=new MutationObserver(n=>{var s;for(let d of n)d.type==="attributes"&&d.attributeName==="class"&&(t.classList.contains(c.className)||(s=h.get(t))==null||s());});o.observe(t,{attributes:true,attributeFilter:["class"]});let i={element:t,parent:e,naturalRect:{top:0,left:0,height:0,width:0},lastScrollPos:0,isSticky:false,isTransforming:false,currentTranslation:0,cachedConfig:{valid:false,edge:"top",offset:0},cachedViewportSize:0,cachedViewportPadding:H,attributeObserver:o};t.setAttribute(c.attrName,"static"),y.set(t,i),q(i),M.observe(t),M.observe(e);let l=false,r=()=>{l||(window.requestAnimationFrame(()=>{V(i),l=false;}),l=true);},a=e===document.documentElement?window:e;a.addEventListener("scroll",r,{passive:true}),h.set(t,()=>{a.removeEventListener("scroll",r),o.disconnect(),M.unobserve(t);let n=false;for(let[s,d]of y.entries())if(s!==t&&d.parent===e){n=true;break}n||M.unobserve(e),y.delete(t),h.delete(t);});},K=t=>{let e=false;for(let{type:o,addedNodes:i,removedNodes:l}of t)o==="childList"&&(i.forEach(r=>{r instanceof HTMLElement&&(r.classList.contains(c.className)&&L(r),r.querySelectorAll(`.${c.className}`).forEach(a=>L(a)));}),e=e||!!l.length);e&&Array.from(h.keys()).forEach(o=>{var i;document.contains(o)||(i=h.get(o))==null||i();});},Q=t=>{if(t.animationName==="sticky-polite-announce"){let e=t.target;h.has(e)||L(e);}},x=()=>{A(),document.addEventListener("animationstart",Q),window.visualViewport?window.visualViewport.addEventListener("resize",D):window.addEventListener("resize",D),document.querySelectorAll(`.${c.className}`).forEach(t=>L(t)),new MutationObserver(K).observe(document.body,{childList:true,subtree:true});};typeof window<"u"&&(document.readyState==="loading"?document.addEventListener("DOMContentLoaded",x):x());var ft=x;module.exports=ft;//# sourceMappingURL=index.cjs.map
//# sourceMappingURL=index.cjs.map